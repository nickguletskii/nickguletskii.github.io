---
layout: post
title:  "How to fix accelerators (keyboard shortcuts) not working with Swing actions"
description: "How to fix accelerators (keyboard shortcuts) not working with Swing actions"
date:   2014-06-15 13:21:43
categories: java swing
tags: java swing action menu keyboard accelerator key
---

Let's start with a piece of code that seems to be correct at the first glance...

{% highlight java %}
JMenuItem mntmTest = new JMenuItem("Test");
mntmTest.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_T, InputEvent.CTRL_MASK));
mntmTest.setAction(action);	
{% endhighlight %}

This snippet was generated by Eclipse WindowBuilder.

Looks good to you? Well... It's not. The menu item will not have an accelerator key combination.

<div class="important warning">
	<strong>Always</strong> check autogenerated code if you can.
</div>

The problem with this code is that Swing actions have their own accelerator key property and when you set the action for a menu item, that menu's accelerator gets replaced with the action's accelerator. In other words, the snippet above is equivalent to this:

{% highlight java %}
JMenuItem mntmTest = new JMenuItem("Test");
mntmTest.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_T, InputEvent.CTRL_MASK));
mntmTest.setAction(action);
mntmTest.setAccelerator(null);
{% endhighlight %}

The obvious solution would be to put setAccelerator after setAction, like this:

{% highlight java %}
JMenuItem mntmTest = new JMenuItem("Test");
mntmTest.setAction(action);
mntmTest.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_T, InputEvent.CTRL_MASK));
{% endhighlight %}

But that is by far not the best way to do this! A better way to do this would be to set the action's accelerator key stroke.

Your action's constructor might look like this:

{% highlight java %}
public SwingAction() {
	this.putValue(NAME, "SwingAction");
	this.putValue(SHORT_DESCRIPTION, "Some short description");
}
{% endhighlight %}

Let's add the accelerator key:

{% highlight java %}
public SwingAction() {
	this.putValue(NAME, "SwingAction");
	this.putValue(SHORT_DESCRIPTION, "Some short description");
	this.putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_T, InputEvent.CTRL_MASK));	
}
{% endhighlight %}

Now, we don't need to call setAccelerator on mntmTest because it will be called automatically in setAction.

Final code
----------

{% highlight java %}
public SwingAction() {
	this.putValue(NAME, "SwingAction");
	this.putValue(SHORT_DESCRIPTION, "Some short description");
	this.putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_T, InputEvent.CTRL_MASK));	
}
{% endhighlight %}


{% highlight java %}
JMenuItem mntmTest = new JMenuItem("Test");
mntmTest.setAction(action);
{% endhighlight %}